---
title: 'Next.js App Routerにおけるデータフェッチ：クライアントサイドとサーバーサイドの選択'
description: ''
date: '2025-04-01'
author: 'Akimasa Sugai'
tags: ['Next.js', 'App Router', 'データフェッチ', 'クライアントサイド', 'サーバーサイド']
---

# Next.js App Routerにおけるデータフェッチ：クライアントサイドとサーバーサイドの選択

Next.js AppRouterにおけるデータフェッチ、クライアントサイドかサーバーサイドかどちらで行うのか？


# クライアントフェッチとサーバーフェッチの違い

## 1. データフェッチのタイミング
- **サーバーコンポーネント**: ページレンダリング前にデータ取得が完了。初期HTMLに必要なデータが含まれる
- **クライアントコンポーネント(useEffect)**: ブラウザでコンポーネントがマウントされた後にデータフェッチが開始される

## 2. パフォーマンスへの影響
- **サーバーコンポーネント**:
  - 初回ロード時間が短縮（データはサーバーで取得済み）
  - ネットワークリクエスト数の削減
  - サーバーとデータベース間の通信が高速（低レイテンシー）
  
- **クライアントコンポーネント**:
  - 初期ロードは空の状態でレンダリングされる（骨組み表示）
  - ブラウザからAPIへの追加リクエストが発生
  - クライアントからデータベースへのアクセスに高レイテンシー

## 3. UXとローディング体験
- **サーバーコンポーネント**:
  - コンテンツフラッシュ（CLS）が少ない
  - データ込みでレンダリングされるためレイアウトがより安定
  
- **クライアントコンポーネント**:
  - ローディング状態から完了状態への遷移が明確に見える
  - インタラクティブなローディング表示が実装しやすい

## 4. SEO対応
- **サーバーコンポーネント**: データがHTMLに含まれるため、検索エンジンがコンテンツを認識できる
- **クライアントコンポーネント**: JavaScriptが実行された後にデータが表示されるため、クローラーが見落とす可能性がある

## 5. セキュリティ面
- **サーバーコンポーネント**: 
  - 機密データやトークンがクライアントに露出しない
  - サーバー上でのみ実行される認証・認可ロジック
  
- **クライアントコンポーネント**:
  - 公開APIエンドポイントが必要
  - フロントエンド側で認証情報や秘密情報の扱いに注意が必要

## 6. 実装の複雑さ
- **サーバーコンポーネント**:
  - データ取得とレンダリングが一体化
  - エラーハンドリングがシンプル
  
- **クライアントコンポーネント**:
  - ローディング状態、エラー状態、成功状態の管理が必要
  - データ取得ロジックとUIロジックが混在しやすい

## ベストプラクティス
- **サーバーで取得するべきデータ**:
  - 初期表示に必要な静的/準静的データ
  - SEO重要なコンテンツ
  - 機密性の高いデータ処理
  
- **クライアントで取得するべきデータ**:
  - ユーザーインタラクション後に必要なデータ
  - 頻繁に更新される動的データ
  - パーソナライズされたコンテンツ

Next.jsのApp Routerでは、サーバーコンポーネントをデフォルトとして活用しつつ、クライアントコンポーネントは対話性が必要な部分に限定して使用することで、両方のメリットを活かした設計が可能です。
