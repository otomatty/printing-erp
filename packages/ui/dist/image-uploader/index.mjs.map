{"version":3,"sources":["../../src/shadcn/label/index.tsx","../../src/makerkit/image-upload-input/index.tsx","../../src/makerkit/image-uploader/index.tsx"],"names":["labelVariants","cva","Label","className","props","ref","cn","IMAGE_SIZE","ImageUploadInput","children","image","onClear","onInput","onValueChange","forwardedRef","visible","localRef","useRef","state","setState","useState","onInputChange","useCallback","e","files","file","data","onRemove","imageRemoved","setRef","input","useEffect","Input","If","UploadCloud","Image","Button","X","ImageUploader","setImage","setValue","register","useForm","control","Trans","FallbackImage","ImageIcon"],"mappings":"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","file":"index.mjs","sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport * as LabelPrimitive from '@radix-ui/react-label';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '../../lib/utils';\n\nconst labelVariants = cva(\n  'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70'\n);\n\nconst Label = React.forwardRef<\n  React.ComponentRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n));\nLabel.displayName = LabelPrimitive.Root.displayName;\n\nexport { Label };\n","'use client';\n\nimport type { FormEvent, MouseEventHandler } from 'react';\nimport { useCallback, useEffect, useRef, useState } from 'react';\n\nimport Image from 'next/image';\n\nimport { UploadCloud, X } from 'lucide-react';\n\nimport { Button } from '../../shadcn/button';\nimport { Label } from '../../shadcn/label';\nimport { If } from '../if';\nimport { cn } from '../../lib/utils';\n\ntype Props = Omit<React.InputHTMLAttributes<HTMLInputElement>, 'value'> & {\n  image?: string | null;\n  onClear?: () => void;\n  onValueChange?: (props: { image: string; file: File }) => void;\n  visible?: boolean;\n  ref?: React.Ref<HTMLInputElement>;\n};\n\nconst IMAGE_SIZE = 22;\n\nexport const ImageUploadInput: React.FC<Props> =\n  function ImageUploadInputComponent({\n    children,\n    image,\n    onClear,\n    onInput,\n    onValueChange,\n    ref: forwardedRef,\n    visible = true,\n    ...props\n  }) {\n    const localRef = useRef<HTMLInputElement>(null);\n\n    const [state, setState] = useState({\n      image,\n      fileName: '',\n    });\n\n    const onInputChange = useCallback(\n      (e: FormEvent<HTMLInputElement>) => {\n        e.preventDefault();\n\n        const files = e.currentTarget.files;\n\n        if (files?.length) {\n          const file = files[0];\n\n          if (!file) {\n            return;\n          }\n\n          const data = URL.createObjectURL(file);\n\n          setState({\n            image: data,\n            fileName: file.name,\n          });\n\n          if (onValueChange) {\n            onValueChange({\n              image: data,\n              file,\n            });\n          }\n        }\n\n        if (onInput) {\n          onInput(e);\n        }\n      },\n      [onInput, onValueChange]\n    );\n\n    const onRemove = useCallback(() => {\n      setState({\n        image: '',\n        fileName: '',\n      });\n\n      if (localRef.current) {\n        localRef.current.value = '';\n      }\n\n      if (onClear) {\n        onClear();\n      }\n    }, [onClear]);\n\n    const imageRemoved: MouseEventHandler = useCallback(\n      (e) => {\n        e.preventDefault();\n\n        onRemove();\n      },\n      [onRemove]\n    );\n\n    const setRef = useCallback(\n      (input: HTMLInputElement) => {\n        localRef.current = input;\n\n        if (typeof forwardedRef === 'function') {\n          forwardedRef(localRef.current);\n        }\n      },\n      [forwardedRef]\n    );\n\n    useEffect(() => {\n      setState((state) => ({ ...state, image }));\n    }, [image]);\n\n    useEffect(() => {\n      if (!image) {\n        onRemove();\n      }\n    }, [image, onRemove]);\n\n    const Input = () => (\n      <input\n        {...props}\n        className={cn('hidden', props.className)}\n        ref={setRef}\n        type={'file'}\n        onInput={onInputChange}\n        accept=\"image/*\"\n        aria-labelledby={'image-upload-input'}\n      />\n    );\n\n    if (!visible) {\n      return <Input />;\n    }\n\n    return (\n      <label\n        id={'image-upload-input'}\n        htmlFor=\"file-input\"\n        className={\n          'border-input bg-background ring-primary ring-offset-background placeholder:text-muted-foreground focus-visible:ring-ring relative flex h-10 w-full cursor-pointer rounded-md border border-dashed px-3 py-2 text-sm ring-offset-2 outline-hidden transition-all file:border-0 file:bg-transparent file:text-sm file:font-medium focus:ring-2 focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-hidden disabled:cursor-not-allowed disabled:opacity-50'\n        }\n      >\n        <input\n          {...props}\n          id={'file-input'}\n          className={cn('hidden', props.className)}\n          ref={setRef}\n          type={'file'}\n          onInput={onInputChange}\n          accept=\"image/*\"\n          aria-labelledby={'image-upload-input'}\n        />\n\n        <div className={'flex items-center space-x-4'}>\n          <div className={'flex'}>\n            <If condition={!state.image}>\n              <UploadCloud className={'text-muted-foreground h-5'} />\n            </If>\n\n            <If condition={state.image}>\n              <Image\n                loading={'lazy'}\n                style={{\n                  width: IMAGE_SIZE,\n                  height: IMAGE_SIZE,\n                }}\n                className={'object-contain'}\n                width={IMAGE_SIZE}\n                height={IMAGE_SIZE}\n                src={state.image ?? ''}\n                alt={props.alt ?? ''}\n              />\n            </If>\n          </div>\n\n          <If condition={!state.image}>\n            <div className={'flex flex-auto'}>\n              <Label className={'cursor-pointer text-xs'}>{children}</Label>\n            </div>\n          </If>\n\n          <If condition={state.image}>\n            <div className={'flex flex-auto'}>\n              <If\n                condition={state.fileName}\n                fallback={\n                  <Label className={'cursor-pointer truncate text-xs'}>\n                    {children}\n                  </Label>\n                }\n              >\n                <Label className={'truncate text-xs'}>{state.fileName}</Label>\n              </If>\n            </div>\n          </If>\n\n          <If condition={state.image}>\n            <Button\n              size={'icon'}\n              className={'h-5! w-5!'}\n              onClick={imageRemoved}\n            >\n              <X className=\"h-4\" />\n            </Button>\n          </If>\n        </div>\n      </label>\n    );\n  };\n","'use client';\n\nimport { useCallback, useEffect, useState } from 'react';\n\nimport { Image as ImageIcon } from 'lucide-react';\nimport { useForm } from 'react-hook-form';\n\nimport { Button } from '../../shadcn/button';\nimport { ImageUploadInput } from '../image-upload-input';\nimport { Trans } from '../trans';\n\nexport function ImageUploader(\n  props: React.PropsWithChildren<{\n    value: string | null | undefined;\n    onValueChange: (value: File | null) => unknown;\n    alt?: string;\n    url?: string;\n  }>\n) {\n  const [image, setImage] = useState(props.value);\n\n  const { setValue, register } = useForm<{\n    value: string | null | FileList;\n  }>({\n    defaultValues: {\n      value: props.value,\n    },\n    mode: 'onChange',\n    reValidateMode: 'onChange',\n  });\n\n  const control = register('value');\n\n  const onClear = useCallback(() => {\n    props.onValueChange(null);\n    setValue('value', null);\n    setImage('');\n  }, [props, setValue]);\n\n  const onValueChange = useCallback(\n    ({ image, file }: { image: string; file: File }) => {\n      props.onValueChange(file);\n\n      setImage(image);\n    },\n    [props]\n  );\n\n  const Input = () => (\n    <ImageUploadInput\n      {...control}\n      accept={'image/*'}\n      className={'absolute h-full w-full'}\n      visible={false}\n      multiple={false}\n      onValueChange={onValueChange}\n    />\n  );\n\n  useEffect(() => {\n    setImage(props.value);\n  }, [props.value]);\n\n  if (!image) {\n    return (\n      <FallbackImage descriptionSection={props.children}>\n        <Input />\n      </FallbackImage>\n    );\n  }\n\n  return (\n    <div className={'flex items-center space-x-4'}>\n      <label\n        htmlFor=\"image-upload\"\n        className={'animate-in fade-in zoom-in-50 relative h-20 w-20'}\n      >\n        {/* eslint-disable-next-line @next/next/no-img-element */}\n        <img\n          alt={props.alt ?? ''}\n          className={'h-full w-full rounded-full object-cover'}\n          src={props.url}\n        />\n\n        <Input />\n      </label>\n\n      <div>\n        <Button onClick={onClear} size={'sm'} variant={'ghost'}>\n          <Trans i18nKey={'common:clear'} />\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nfunction FallbackImage(\n  props: React.PropsWithChildren<{\n    descriptionSection?: React.ReactNode;\n  }>\n) {\n  return (\n    <div className={'flex items-center space-x-4'}>\n      <label\n        htmlFor={'image-upload'}\n        className={\n          'border-border animate-in fade-in zoom-in-50 hover:border-primary relative flex h-20 w-20 cursor-pointer flex-col items-center justify-center rounded-full border'\n        }\n      >\n        <ImageIcon className={'text-primary h-8'} />\n\n        {props.children}\n      </label>\n\n      {props.descriptionSection}\n    </div>\n  );\n}\n"]}